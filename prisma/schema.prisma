generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Administrator {
  id            Int     @id @default(autoincrement())
  name          String
  email         String  @unique
  password      String
  status        Boolean @default(true)
  token_recover String?
  otp_code      String?
  avatar        String  @default("https://imgcdn.stablediffusionweb.com/2024/5/8/852aa9d2-d1f0-4353-b8f0-cd4f45e8c862.jpg")
  @@map("administrators")
}

model AffiliateHistory {
  id                                                 Int      @id @default(autoincrement())
  user_id                                            Int
  affiliate_user_id                                  Int
  amount                                             Decimal  @default(0.00) @db.Decimal(10, 2)
  cpa_level                                          Int      @default(0)
  revshare_level                                     Int      @default(0)
  type                                               String
  created_at                                         DateTime @default(now())
  affiliate_user                                     User     @relation("affiliate_histories_affiliate_user_idTousers", fields: [affiliate_user_id], references: [id])
  user                                               User     @relation("affiliate_histories_user_idTousers", fields: [user_id], references: [id], onDelete: Cascade)

  @@index([affiliate_user_id])
  @@index([user_id, created_at])
  @@map("affiliate_histories")
}

model Banner {
  id         Int      @id @default(autoincrement())
  name       String
  image_url  String
  target_url String
  is_active  Boolean  @default(true)
  sort_order Int      @default(0)
  created_at DateTime @default(now())
  updated_at DateTime
  @@map("banners")
}

model Category {
  id           Int      @id @default(autoincrement())
  name         String
  image        String
  is_active    Boolean  @default(true)
  show_in_home Boolean  @default(true)
  created_at   DateTime @default(now())
  updated_at   DateTime
  games        Game[]   @relation("CategoryToGame")
  @@map("categories")
}

model ChestWithdrawal {
  id         Int      @id @default(autoincrement())
  user_id    Int
  chest_id   Int
  amount     Decimal  @default(0.00) @db.Decimal(10, 2)
  status     Boolean  @default(false)
  created_at DateTime @default(now())
  updated_at DateTime
  chest      Chest    @relation(fields: [chest_id], references: [id])
  user       User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([chest_id])
  @@index([user_id, created_at])
  @@map("chest_withdrawls")
}

model Chest {
  id               Int                @id @default(autoincrement())
  need_referral    Int                @default(0)
  need_deposit     Decimal            @default(0.00) @db.Decimal(10, 2)
  need_bet         Decimal            @default(0.00) @db.Decimal(10, 2)
  bonus            Decimal            @default(0.00) @db.Decimal(10, 2)
  is_active        Boolean            @default(true)
  created_at       DateTime           @default(now())
  updated_at       DateTime
  chest_withdrawls ChestWithdrawal[]
  @@map("chests")
}

model DefaultAffiliateBonus {
  id                  Int     @id @default(autoincrement())
  cpa_level_1         Decimal @default(0.00) @db.Decimal(10, 2)
  cpa_level_2         Decimal @default(0.00) @db.Decimal(10, 2)
  cpa_level_3         Decimal @default(0.00) @db.Decimal(10, 2)
  revshare_fake       Decimal @default(0.00) @db.Decimal(10, 2)
  revshare_level_1    Decimal @default(0.00) @db.Decimal(10, 2)
  revshare_level_2    Decimal @default(0.00) @db.Decimal(10, 2)
  revshare_level_3    Decimal @default(0.00) @db.Decimal(10, 2)
  min_deposit_for_cpa Decimal @default(0.00) @db.Decimal(10, 2)
  fake_revshare       Boolean @default(false)
  @@map("default_affiliate_bonuses")
}

model DepositPromoEvent {
  id                  Int                   @id @default(autoincrement())
  name                String
  start_date          DateTime
  end_date            DateTime
  is_active           Boolean               @default(true)
  created_at          DateTime              @default(now())
  updated_at          DateTime
  deposit_promo_tiers DepositPromoTier[]
  @@map("deposit_promo_events")
}

model DepositPromoParticipation {
  id                  Int                 @id @default(autoincrement())
  user_id             Int
  tier_id             Int
  deposit_id          Int
  promo_date          DateTime
  created_at          DateTime            @default(now())
  deposit             Deposit             @relation(fields: [deposit_id], references: [id], onDelete: Cascade)
  tier                DepositPromoTier    @relation(fields: [tier_id], references: [id], onDelete: Cascade)
  user                User                @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([deposit_id])
  @@index([tier_id])
  @@index([user_id, promo_date])
  @@map("deposit_promo_participations")
}

model DepositPromoTier {
  id                           Int                            @id @default(autoincrement())
  event_id                     Int
  name                         String
  deposit_amount               Decimal                        @default(0.00) @db.Decimal(10, 2)
  bonus_amount                 Decimal                        @default(0.00) @db.Decimal(10, 2)
  rollover_amount              Decimal                        @default(0.00) @db.Decimal(10, 2)
  is_active                    Boolean                        @default(true)
  sort_order                   Int                            @default(0)
  created_at                   DateTime                       @default(now())
  updated_at                   DateTime
  deposit_promo_participations DepositPromoParticipation[]
  event                        DepositPromoEvent              @relation(fields: [event_id], references: [id], onDelete: Cascade)

  @@index([event_id])
  @@map("deposit_promo_tiers")
}

model Deposit {
  id                           Int                            @id @default(autoincrement())
  user_id                      Int
  amount                       Decimal                        @default(0.00) @db.Decimal(10, 2)
  status                       String                         @default("PENDING")
  request_number               String?
  reference                    String?
  paid_at                      DateTime?
  updated_at                   DateTime
  created_at                   DateTime                       @default(now())
  deposit_promo_participations DepositPromoParticipation[]
  user                         User                           @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([user_id, created_at, status, reference])
  @@map("deposits")
}

model GameTransaction {
  id                      Int      @id @default(autoincrement())
  user_id                 Int
  action                  String
  provider                String
  player_id               Int
  session_id              String?
  provider_transaction_id String?
  internal_transaction_id String?
  game_uuid               String?
  round_id                String?
  amount                  Decimal? @db.Decimal(10, 2)
  currency                String?  @default("BRL")
  raw_request             String?  @db.LongText
  created_at              DateTime @default(now())
  user                    User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([player_id, created_at])
  @@index([provider_transaction_id])
  @@index([user_id, created_at])
  @@map("game_transactions")
}

model Game {
  id           Int              @id @default(autoincrement())
  name         String
  game_code    String
  game_id      String?
  image        String?
  description  String?          @db.Text
  game_type    GamesType?
  currency     String?          @default("BRL")
  rtp          Decimal?         @db.Decimal(5, 2)
  status       String           @default("active")
  distribution String?
  is_hot       Boolean          @default(false)
  is_active    Boolean          @default(true)
  show_in_home Boolean          @default(true)
  views        Int              @default(0)
  weight       Int              @default(0)
  created_at   DateTime         @default(now())
  updated_at   DateTime
  categories   Category[]       @relation("CategoryToGame")
  @@map("games")
}

model LevelPromoBonus {
  id                Int               @id @default(autoincrement())
  tier_id           Int
  day_index         Int
  bonus_value       Decimal           @default(0.00) @db.Decimal(10, 2)
  tier              LevelPromoTier    @relation(fields: [tier_id], references: [id], onDelete: Cascade)

  @@index([tier_id, day_index])
  @@map("level_promo_bonuses")
}

model LevelPromoProgress {
  id              Int       @id @default(autoincrement())
  user_id         Int
  current_day     Int       @default(0)
  last_checkin_at DateTime?
  created_at      DateTime  @default(now())
  updated_at      DateTime
  user            User      @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([user_id])
  @@map("level_promo_progresses")
}

model LevelPromoTier {
  id                  Int                   @id @default(autoincrement())
  name                String
  min_volume          Decimal               @default(0.00) @db.Decimal(10, 2)
  level_promo_bonuses LevelPromoBonus[]
  @@map("level_promo_tiers")
}

model Mensage {
  id         Int      @id @default(autoincrement())
  title      String
  content    String
  is_active  Boolean  @default(true)
  created_at DateTime @default(now())
  updated_at DateTime
  @@map("messages")
}

model PGCloneProvider {
  id           Int      @id @default(autoincrement())
  base_url     String   @default("https://api.apipokergames.site/api/v1/")
  agent_code   String
  agent_secret String
  agent_token  String
  active       Boolean  @default(true)
  created_at   DateTime @default(now())
  updated_at   DateTime
  @@map("pg_clone_providers")
}

model PokerProvider {
  id           Int      @id @default(autoincrement())
  base_url     String   @default("https://pokersgamessistemas.com/api/v1/")
  agent_code   String
  agent_secret String
  agent_token  String
  active       Boolean  @default(true)
  created_at   DateTime @default(now())
  updated_at   DateTime
  @@map("poker_providers")
}

model PopupBanner {
  id         Int      @id @default(autoincrement())
  name       String
  image_url  String
  target_url String
  is_active  Boolean  @default(true)
  sort_order Int      @default(0)
  created_at DateTime @default(now())
  updated_at DateTime
  @@map("popup_banners")
}

model PopupIcon {
  id         Int      @id @default(autoincrement())
  name       String
  image_url  String
  target_url String
  is_active  Boolean  @default(true)
  direction  String   @default("right")
  created_at DateTime @default(now())
  updated_at DateTime

  @@map("popup_icons")
}

model PpCloneProvider {
  id           Int      @id @default(autoincrement())
  base_url     String   @default("https://api.pragmaticslots.fun/")
  agent_code   String
  agent_secret String
  active       Boolean  @default(true)
  created_at   DateTime @default(now())
  updated_at   DateTime

  @@map("pp_clone_providers")
}

model PradaPayment {
  id         Int      @id @default(autoincrement())
  base_url   String   @default("https://api.pradapay.com")
  api_key    String
  active     Boolean  @default(true)
  created_at DateTime @default(now())
  updated_at DateTime

  @@map("prada_payments")
}

model Promotion {
  id         Int       @id @default(autoincrement())
  name       String
  icon_url   String
  image_url  String
  target_url String
  is_active  Boolean   @default(true)
  sort_order Int       @default(0)
  starts_at  DateTime?
  ends_at    DateTime?
  created_at DateTime  @default(now())
  updated_at DateTime

  @@map("promotions")
}

model RakebackHistory {
  id                Int               @id @default(autoincrement())
  user_id           Int
  setting_id        Int
  amount            Decimal           @default(0.00) @db.Decimal(10, 2)
  redeemed          Boolean           @default(false)
  redeemed_at       DateTime?
  created_at        DateTime          @default(now())
  rakeback_settings RakebackSetting   @relation(fields: [setting_id], references: [id], onDelete: Cascade)
  user              User              @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([setting_id])
  @@index([user_id, created_at])
  @@map("rakeback_histories")
}

model RakebackSetting {
  id                 Int                  @id @default(autoincrement())
  name               String
  min_volume         Decimal              @default(0.00) @db.Decimal(10, 2)
  percentage         Decimal              @default(0.00) @db.Decimal(10, 2)
  is_active          Boolean              @default(true)
  created_at         DateTime             @default(now())
  updated_at         DateTime
  rakeback_histories RakebackHistory[]
  @@map("rakeback_settings")
}

model ReedemCodeHistory {
  id             Int          @id @default(autoincrement())
  reedem_code_id Int
  user_id        Int
  collected_at   DateTime     @default(now())
  bonus          Decimal?     @default(0.00) @db.Decimal(10, 2)
  free_spins     Int?         @default(0)
  reedem_code    ReedemCode   @relation(fields: [reedem_code_id], references: [id])
  user           User         @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([reedem_code_id, user_id])
  @@index([user_id], map: "reedem_code_histories_user_id_fkey")
  @@map("reedem_code_histories")
}

model ReedemCode {
  id                    Int                     @id @default(autoincrement())
  code                  String                  @unique
  max_collect           Int                     @default(0)
  collected_count       Int                     @default(0)
  bonus                 Decimal?                @default(0.00) @db.Decimal(10, 2)
  free_spins            Int?                    @default(0)
  is_active             Boolean                 @default(true)
  created_at            DateTime                @default(now())
  updated_at            DateTime
  reedem_code_histories ReedemCodeHistory[]

  @@map("reedem_codes")
}

model Setting {
  id                    Int      @id @default(autoincrement())
  sys_name              String
  sys_favicon           String
  sys_logo              String
  sys_description       String?
  sys_marquee           String?
  sys_support_telegram  String?
  sys_support_whatsapp  String?
  sys_support_email     String?
  min_deposit           Decimal  @default(5.00) @db.Decimal(10, 2)
  max_deposit           Decimal  @default(5000.00) @db.Decimal(10, 2)
  min_withdrawal        Decimal  @default(5.00) @db.Decimal(10, 2)
  max_withdrawal        Decimal  @default(5000.00) @db.Decimal(10, 2)
  auto_withdrawal       Boolean  @default(true)
  auto_withdrawal_limit Decimal  @default(5000.00) @db.Decimal(10, 2)
  need_document         Boolean  @default(true)
  created_at            DateTime @default(now())
  updated_at            DateTime

  @@map("settings")
}

model SubBanner {
  id         Int      @id @default(autoincrement())
  name       String
  image_url  String
  target_url String
  is_active  Boolean  @default(true)
  sort_order Int      @default(0)
  created_at DateTime @default(now())
  updated_at DateTime

  @@map("sub_banners")
}

model User {
  id                                                               Int                            @id @default(autoincrement())
  pid                                                              String                         @unique
  phone                                                            String                         @unique
  document                                                         String?                        @unique
  password                                                         String
  balance                                                          Decimal                        @default(0.00) @db.Decimal(10, 2)
  affiliate_balance                                                Decimal                        @default(0.00) @db.Decimal(10, 2)
  vip_balance                                                      Decimal                        @default(0.00) @db.Decimal(10, 2)
  vip                                                              Int                            @default(0)
  affiliate_code                                                   String?                        @unique
  invited_by_user_id                                               Int?
  password_withdrawal                                              String?
  rollover_active                                                  Boolean                        @default(false)
  rollover_multiplier                                              Decimal                        @default(1.00) @db.Decimal(10, 2)
  blogger                                                          Boolean                        @default(false)
  banned                                                           Boolean                        @default(false)
  status                                                           Boolean                        @default(true)
  created_at                                                       DateTime                       @default(now())
  updated_at                                                       DateTime
  last_login_at                                                    DateTime?
  banned_at                                                        DateTime?
  jump_available                                                   Boolean                        @default(false)
  jump_limit                                                       Int                            @default(2)
  jump_invite_count                                                Int                            @default(0)
  cpa_available                                                    Boolean                        @default(false)
  min_deposit_for_cpa                                              Decimal                        @default(0.00) @db.Decimal(10, 2)
  cpa_level_1                                                      Decimal                        @default(0.00) @db.Decimal(10, 2)
  cpa_level_2                                                      Decimal                        @default(0.00) @db.Decimal(10, 2)
  cpa_level_3                                                      Decimal                        @default(0.00) @db.Decimal(10, 2)
  revshare_fake                                                    Decimal                        @default(0.00) @db.Decimal(10, 2)
  revshare_level_1                                                 Decimal                        @default(0.00) @db.Decimal(10, 2)
  revshare_level_2                                                 Decimal                        @default(0.00) @db.Decimal(10, 2)
  revshare_level_3                                                 Decimal                        @default(0.00) @db.Decimal(10, 2)
  fake_revshare                                                    Boolean                        @default(false)
  affiliate_histories_affiliate_histories_affiliate_user_idTousers AffiliateHistory[]             @relation("affiliate_histories_affiliate_user_idTousers")
  affiliate_histories_affiliate_histories_user_idTousers           AffiliateHistory[]             @relation("affiliate_histories_user_idTousers")
  chest_withdrawls                                                 ChestWithdrawal[]
  deposit_promo_participations                                     DepositPromoParticipation[]
  deposits                                                         Deposit[]
  game_transactions                                                GameTransaction[]
  level_promo_progresses                                           LevelPromoProgress[]
  rakeback_histories                                               RakebackHistory[]
  reedem_code_histories                                            ReedemCodeHistory[]
  users                                                            User?                          @relation("usersTousers", fields: [invited_by_user_id], references: [id])
  other_users                                                      User[]                         @relation("usersTousers")
  vip_bonus_redemptions                                            VipBonusRedemption[]
  vip_histories                                                    VipHistory[]
  withdrawals                                                      Withdrawal[]

  @@index([affiliate_code])
  @@index([created_at])
  @@index([invited_by_user_id])
  @@index([last_login_at])
  @@index([status, banned])
  @@map("users")
}

model VipBonusRedemption {
  id         Int      @id @default(autoincrement())
  user_id    Int
  bonus_type String
  amount     Decimal  @default(0.00) @db.Decimal(10, 2)
  created_at DateTime @default(now())
  user       User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([user_id, bonus_type, created_at])
  @@map("vip_bonus_redemptions")
}

model VipHistory {
  id           Int        @id @default(autoincrement())
  user_id      Int
  vip_level_id Int
  goal         Decimal    @default(0.00) @db.Decimal(10, 2)
  bonus        Decimal    @default(0.00) @db.Decimal(10, 2)
  kind         String     @default("upgrade")
  created_at   DateTime   @default(now())
  user         User       @relation(fields: [user_id], references: [id], onDelete: Cascade)
  vip_level    VipLevel   @relation(fields: [vip_level_id], references: [id])

  @@index([user_id, created_at])
  @@index([vip_level_id])
  @@map("vip_histories")
}

model VipLevel {
  id            Int             @id @default(autoincrement())
  id_vip        Int             @default(0)
  goal          Decimal         @default(0.00) @db.Decimal(10, 2)
  bonus         Decimal         @default(0.00) @db.Decimal(10, 2)
  weekly_bonus  Decimal         @default(0.00) @db.Decimal(10, 2)
  monthly_bonus Decimal         @default(0.00) @db.Decimal(10, 2)
  vip_histories VipHistory[]

  @@index([id_vip])
  @@map("vip_levels")
}

model Withdrawal {
  id             Int       @id @default(autoincrement())
  user_id        Int
  amount         Decimal   @default(0.00) @db.Decimal(10, 2)
  status         String    @default("PENDING")
  request_number String?
  user_name      String?
  user_document  String?
  user_keypix    String?
  user_keytype   String?
  reason         String?
  reference      String?
  paid_at        DateTime?
  updated_at     DateTime
  created_at     DateTime  @default(now())
  user           User      @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([user_id, created_at, status, reference])
  @@map("withdrawals")
}

enum GamesType {
  SLOTS
  FISHING
  CASINO
}
